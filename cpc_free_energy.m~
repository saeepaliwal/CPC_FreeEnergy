%% Explore dynamics of beta
clear
% Define priors
a_0 = 1;
b_0 = 1;
mu_0 = 0;
la_0 = 1;

N = 1e5;
x = normrnd(5,0.5,N,1);


% Generate data
N = 1e5;
x = normrnd(5,1,N,1);

betas = [0.5 1 5 10 100 1000];

% Put data and sufficient statistics into F function
for i = 1:length(betas)
    be = betas(i);
    
    [F(b),H(b),mu_N(b),la_N(b),a_N(b),b_N(b)]  = vb(x,be,mu_0,la_0,a_0,b_0);
    
end

[F(i)] = free_energy(x,N,be,a_N, b_N, la_N, mu_N,a_0,b_0,mu_0,la_0);

% Plot: Free energy versus beta
figure;
plot(betas,F,'.--','LineWidth',2)



